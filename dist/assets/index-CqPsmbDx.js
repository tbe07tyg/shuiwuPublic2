import{_ as O,e as R,h as i,d as E,i as A,u as G,c as J,a as l,j as o,n as x,k as C,w as a,l as u,m as K,o as k,p as y,t as Q,f as v}from"./index-CLrs7Nd9.js";const W={class:"login-bg"},X={class:"login-main"},Y={class:"login-form-wrap"},Z={class:"login-form-box"},ee={class:"login-card"},oe={class:"login-custom-tabs"},ae={class:"login-form-content"},te={class:"captcha-row"},le={__name:"index",setup(se){const s=R({username:"",password:"",mobile:"",captcha:""}),F={username:[{required:!0,message:""}],password:[{required:!0,message:""}]},z={mobile:[{required:!0,message:""},{pattern:/^1\d{10}$/,message:""}],captcha:[{required:!0,message:""}]},I=i(),S=i(),d=i(!1),m=i("account"),U=[{ip:"192.168.1.1",time:"2024-06-01 10:00",abnormal:!1},{ip:"8.8.8.8",time:"2024-06-02 09:30",abnormal:!0}],$=E(()=>U.map(f=>`<span style='color:${f.abnormal?"red":"#333"}'>${f.ip}（${f.time}）</span>`).join("<br/>")),q=K(),T=async()=>{d.value=!0,localStorage.setItem("token","mock-token-"+Date.now()),setTimeout(()=>{d.value=!1,q.push("/dashboard")},500)},B=async()=>{d.value=!0,setTimeout(()=>{d.value=!1,v.success("登录成功")},1e3)},r=i(0);let h=null;const j=()=>{r.value>0||(r.value=60,h=setInterval(()=>{r.value--,r.value<=0&&clearInterval(h)},1e3),v.success("验证码已发送（模拟）"))},p=i(!1),c=R({newPwd:"",confirmPwd:""}),N={newPwd:[{required:!0,message:"请输入新密码"}],confirmPwd:[{required:!0,message:"请再次输入新密码"},{validator:(f,e)=>e!==c.newPwd?Promise.reject("两次输入的密码不一致"):Promise.resolve(),trigger:"blur"}]},P=i(),V=()=>{P.value.validate().then(()=>{p.value=!1,localStorage.setItem("token","mock-token"),v.success("密码修改成功，欢迎使用！"),window.location.href="/dashboard"}).catch(()=>{})},D=()=>{p.value=!1,localStorage.setItem("token","mock-token"),v.success("密码修改成功，欢迎使用！"),window.location.href="/dashboard"},H=G();return A(()=>{localStorage.getItem("token")&&H.path==="/login"&&(window.location.href="/dashboard")}),(f,e)=>{const _=u("a-input"),n=u("a-form-item"),w=u("a-input-password"),g=u("a-button"),L=u("a-tooltip"),b=u("a-form"),M=u("a-modal");return k(),J("div",W,[l("div",X,[e[11]||(e[11]=l("div",{class:"login-side"},[l("div",{class:"side-title"},"科技创新管控系统"),l("div",{class:"side-desc"},"让科研管理更高效、更智能")],-1)),l("div",Y,[l("div",Z,[l("div",ee,[l("div",oe,[l("div",{class:x(["login-custom-tab",m.value==="account"&&"active"]),onClick:e[0]||(e[0]=t=>m.value="account")},"账号登录",2),l("div",{class:x(["login-custom-tab",m.value==="mobile"&&"active"]),onClick:e[1]||(e[1]=t=>m.value="mobile")},"手机验证码登录",2)]),l("div",ae,[m.value==="account"?(k(),C(b,{key:0,model:s,rules:F,ref_key:"formRef",ref:I,onFinish:T,layout:"vertical"},{default:a(()=>[o(n,{name:"username"},{default:a(()=>[o(_,{value:s.username,"onUpdate:value":e[2]||(e[2]=t=>s.username=t),size:"large",placeholder:"请输入用户名",style:{width:"100%"}},null,8,["value"])]),_:1}),o(n,{name:"password"},{default:a(()=>[o(w,{value:s.password,"onUpdate:value":e[3]||(e[3]=t=>s.password=t),size:"large",placeholder:"请输入密码"},null,8,["value"])]),_:1}),o(n,{class:"login-btn-row"},{default:a(()=>[o(L,{title:$.value},{default:a(()=>[o(g,{type:"primary","html-type":"submit",class:"full-width-btn",loading:d.value,style:{background:"#234fa2",border:"none",color:"#fff"},block:""},{default:a(()=>e[9]||(e[9]=[y(" 登录 ",-1)])),_:1,__:[9]},8,["loading"])]),_:1},8,["title"])]),_:1})]),_:1},8,["model"])):(k(),C(b,{key:1,model:s,rules:z,ref_key:"mobileFormRef",ref:S,onFinish:B,layout:"vertical"},{default:a(()=>[o(n,{name:"mobile"},{default:a(()=>[o(_,{value:s.mobile,"onUpdate:value":e[4]||(e[4]=t=>s.mobile=t),size:"large",placeholder:"请输入手机号"},null,8,["value"])]),_:1}),o(n,{name:"captcha"},{default:a(()=>[l("div",te,[o(_,{value:s.captcha,"onUpdate:value":e[5]||(e[5]=t=>s.captcha=t),size:"large",placeholder:"请输入验证码",style:{flex:"1"}},null,8,["value"]),o(g,{class:"get-captcha-btn",size:"large",onClick:j,disabled:r.value>0},{default:a(()=>[y(Q(r.value>0?`${r.value}s后重试`:"获取验证码"),1)]),_:1},8,["disabled"])])]),_:1}),o(n,{class:"login-btn-row"},{default:a(()=>[o(g,{type:"primary","html-type":"submit",class:"full-width-btn",loading:d.value,style:{background:"#234fa2",border:"none",color:"#fff"},block:""},{default:a(()=>e[10]||(e[10]=[y(" 登录 ",-1)])),_:1,__:[10]},8,["loading"])]),_:1})]),_:1},8,["model"]))])]),o(M,{open:p.value,"onUpdate:open":e[8]||(e[8]=t=>p.value=t),title:"首次登录请修改密码",onOk:V,closable:!1,maskClosable:!1},{default:a(()=>[o(b,{model:c,rules:N,ref_key:"forcePwdRef",ref:P,onFinish:D,layout:"vertical"},{default:a(()=>[o(n,{name:"newPwd"},{default:a(()=>[o(w,{value:c.newPwd,"onUpdate:value":e[6]||(e[6]=t=>c.newPwd=t),size:"large",placeholder:"请输入新密码"},null,8,["value"])]),_:1}),o(n,{name:"confirmPwd"},{default:a(()=>[o(w,{value:c.confirmPwd,"onUpdate:value":e[7]||(e[7]=t=>c.confirmPwd=t),size:"large",placeholder:"请再次输入新密码"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])])])])])}}},re=O(le,[["__scopeId","data-v-5a5cf6b4"]]);export{re as default};
